{% extends 'base.html' %}

{% block title %}Giriş Yap - Kampüs AI{% endblock %}

{% block content %}
<div class="row justify-content-center mt-5">
    <div class="col-md-6 col-lg-4">
        <div class="card shadow-lg border-0 rounded-3">
            <div class="card-body p-5 text-center">
                
                <h2 class="mb-4 text-primary"><i class="fas fa-door-open"></i> Giriş Yap</h2>

                <div class="btn-group w-100 mb-4" role="group">
                    <button type="button" class="btn btn-primary" id="btnStudent" onclick="showForm('student')">
                        <i class="fas fa-user-graduate"></i> Öğrenci
                    </button>
                    <button type="button" class="btn btn-outline-primary" id="btnTeacher" onclick="showForm('teacher')">
                        <i class="fas fa-chalkboard-teacher"></i> Öğretmen
                    </button>
                </div>
                <li class="nav-item">
                    <a class="nav-link text-primary fw-bold" href="/graph/">
                        <i class="fas fa-project-diagram"></i> AI Ağı
                    </a>
                </li>
                <div id="studentForm">
                    <p class="text-muted">Öğrenci girişi yapın.</p>
                    <div class="mb-3 text-start">
                        <label class="form-label">Email</label>
                        <input type="email" id="studentEmail" class="form-control" value="ogrenci@univ.edu.tr">
                    </div>
                    <div class="mb-3 text-start">
                        <label class="form-label">Şifre</label>
                        <input type="password" id="studentPass" class="form-control" value="12345">
                    </div>
                    <button onclick="loginStudent()" class="btn btn-primary w-100 py-2 fw-bold">
                        Giriş Yap
                    </button>
                </div>

                <div id="teacherForm" style="display: none;">
                    <p class="text-muted">Etkinlik yönetimi için giriş yapın.</p>
                    <div class="mb-3 text-start">
                        <label class="form-label">Öğretmen Email</label>
                        <input type="email" id="teacherEmail" class="form-control" value="ogretmen@univ.edu.tr">
                    </div>
                    <div class="mb-3 text-start">
                        <label class="form-label">Şifre</label>
                        <input type="password" id="teacherPass" class="form-control" value="admin123">
                    </div>
                    <button onclick="loginTeacher()" class="btn btn-dark w-100 py-2 fw-bold">
                        Yönetici Girişi
                    </button>
                </div>

            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Sekmeler Arası Geçiş Fonksiyonu
    function showForm(type) {
        if (type === 'student') {
            document.getElementById('studentForm').style.display = 'block';
            document.getElementById('teacherForm').style.display = 'none';
            
            document.getElementById('btnStudent').className = 'btn btn-primary';
            document.getElementById('btnTeacher').className = 'btn btn-outline-primary';
        } else {
            document.getElementById('studentForm').style.display = 'none';
            document.getElementById('teacherForm').style.display = 'block';
            
            document.getElementById('btnTeacher').className = 'btn btn-primary';
            document.getElementById('btnStudent').className = 'btn btn-outline-primary';
        }
    }

    // Öğrenci Girişi
    async function loginStudent() {
        const email = document.getElementById('studentEmail').value;
        const password = document.getElementById('studentPass').value;
        
        try {
            const response = await fetch('/api/verify-student/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });

            if (response.ok) window.location.href = '/ogrenci/';
            else alert("Hatalı öğrenci bilgileri!");
        } catch (error) {
            console.error(error);
            alert("Sunucu hatası!");
        }
    }

    // Öğretmen Girişi
    async function loginTeacher() {
        const email = document.getElementById('teacherEmail').value;
        const password = document.getElementById('teacherPass').value;

        try {
            const response = await fetch('/api/verify-teacher/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });

            if (response.ok) window.location.href = '/ogretmen/';
            else alert("Hatalı öğretmen şifresi!");
        } catch (error) {
            console.error(error);
            alert("Sunucu hatası!");
        }
    }
</script>
{% endblock %}