{% extends 'base.html' %}

{% block title %}Ã–ÄŸrenci Paneli - KampÃ¼s AI{% endblock %}

{% block content %}
<div class="row mb-5">
    <div class="col-md-8 mx-auto text-center">
        <h1 class="display-5 fw-bold text-primary mb-3">Ne yapmak istersin?</h1>
        <p class="text-muted">Yapay zekaya ruh halini anlat, sana en uygun etkinliÄŸi bulsun.</p>
        
        <div class="input-group input-group-lg shadow-sm">
            <input type="text" id="aiInput" class="form-control" placeholder="Ã–rn: Enerjimi atacak hareketli bir ÅŸeyler arÄ±yorum...">
            <button class="btn btn-primary px-4" type="button" onclick="searchAI()">
                <i class="fas fa-magic"></i> AI ile Bul
            </button>
        </div>
    </div>
</div>

<div class="row" id="resultsArea">
    <div class="col-12 text-center text-muted">
        <i class="fas fa-arrow-up"></i> YukarÄ±ya bir ÅŸeyler yazarak yapay zekayÄ± test et!
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
async function searchAI() {
    const query = document.getElementById('aiInput').value;
    const resultsArea = document.getElementById('resultsArea');
    
    if (!query) return;

    resultsArea.innerHTML = '<div class="text-center mt-4"><div class="spinner-border text-primary" role="status"></div><p>AI DÃ¼ÅŸÃ¼nÃ¼yor...</p></div>';

    try {
        const response = await fetch(`/api/search/?q=${encodeURIComponent(query)}`);
        const data = await response.json();

        resultsArea.innerHTML = ''; // Temizle

        if (data.results.length === 0) {
            resultsArea.innerHTML = '<div class="col-12 text-center text-warning"><h5>ðŸ˜” ÃœzgÃ¼nÃ¼m, buna uygun bir etkinlik bulamadÄ±m.</h5></div>';
            return;
        }

        data.results.forEach(event => {
            // Renk seÃ§imi (Skora gÃ¶re)
            let badgeClass = "bg-secondary";
            let scoreInt = parseInt(event.score.replace('%', ''));
            if(scoreInt > 50) badgeClass = "bg-success";
            else if(scoreInt > 30) badgeClass = "bg-warning text-dark";

            const cardHTML = `
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 shadow border-0 hover-effect">
                        <div class="card-header bg-white border-0 pt-3">
                            <span class="badge ${badgeClass} float-end">
                                <i class="fas fa-brain"></i> AI Skoru: ${event.score}
                            </span>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title fw-bold text-primary">${event.title}</h5>
                            <p class="card-text text-muted">${event.description}</p>
                            <div class="mt-3">
                                ${event.tags.map(tag => `<span class="badge bg-light text-dark border me-1">#${tag}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            resultsArea.innerHTML += cardHTML;
        });

    } catch (error) {
        console.error(error);
        resultsArea.innerHTML = '<div class="alert alert-danger">Bir hata oluÅŸtu!</div>';
    }
}

// Enter tuÅŸu ile arama
document.getElementById('aiInput').addEventListener("keypress", function(event) {
  if (event.key === "Enter") {
    searchAI();
  }
});
</script>

<style>
    .hover-effect:hover {
        transform: translateY(-5px);
        transition: transform 0.3s ease;
    }
</style>
{% endblock %}